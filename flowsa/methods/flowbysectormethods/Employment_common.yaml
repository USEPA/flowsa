_bls_selection_fields_national: &bls_selection_fields_national
  selection_fields:
    Class: Employment
    Location: !include:Location_common.yaml:_national_location

_bls_selection_fields_state: &bls_selection_fields_state
  selection_fields:
    Class: Employment
    Location: !include:Location_common.yaml:_state_location

_bls_selection_fields_county: &bls_selection_fields_county
  selection_fields:
    Class: Employment
    Location: !include:Location_common.yaml:_county_location

_bls_load_and_clean: &bls_load_and_clean
  clean_fba_before_mapping: !script_function:BLS_QCEW estimate_suppressed_qcew
  clean_fba: !script_function:BLS_QCEW clean_qcew_for_fbs

bls_load_and_clean_national:
  <<: *bls_selection_fields_national
  <<: *bls_load_and_clean
  geoscale: national

bls_load_and_clean_state:
  <<: *bls_selection_fields_state
  <<: *bls_load_and_clean
  geoscale: state

bls_load_and_clean_county:
  <<: *bls_selection_fields_county
  <<: *bls_load_and_clean
  geoscale: county

bls_allocation:
  attribution_method: direct

employment_fbs_allocation:
  attribution_method: proportional
  attribute_on: ['SectorProducedBy']
  fill_columns: Location
