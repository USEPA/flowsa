## FBS method for Product x Industry production from Census focused only on
## wholesale or retail products. These products are aligned with their primary
## wholesale or retail industry and assigned as the SectorConsumedBy

!include:BEA_detail_target.yaml
# industry_spec:
#   default: NAICS_6
year: 2017
target_naics_year: 2017
geoscale: national
activity_schema: None

source_names:
  Census_EC_PxI:
    geoscale: national
    year: 2017
    data_format: FBA
    clean_fba_before_activity_sets: !script_function:Census_EC move_flow_to_ACB
    ## ^^ this moves the flow name to ACB and temporarily stores the APB
    # as the flow name

    ## instead could we tweak things so that we map on a diff column
    # (e.g. map to flowName instead of Activity)?
    activity_sets:
      sectors:
        exclusion_fields:
          FlowName: '00' # Formerly the APB
        activity_to_sector_mapping: Census_PxI_WholesaleRetail_primary_wholesale
        clean_fba: !script_function:Census_EC keep_wholesale_retail
        # Keep only NAPCS that start with 4 (Wholesale) or 5 (Retail)
        clean_fba_w_sec: !script_function:Census_EC clean_after_attr_m1
        # Moves the FlowName back to the SPB (with no mappings/adjustments)
        # And also stores the original NAPCS code back as the flowname
        attribution_method: direct
