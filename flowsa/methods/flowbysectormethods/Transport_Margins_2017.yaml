## FBS method for Transport Margins based on FAF
## Transport modes are assigned as SectorProducedBy while commodities moved are
## assigned as SectorConsumedBy

!include:BEA_detail_target.yaml
# industry_spec:
#   default: NAICS_6
year: 2017
target_naics_year: 2017
geoscale: national

source_names:
  BTS_FAF:
    geoscale: national
    year: 2017
    clean_fba_before_activity_sets: !script_function:BTS_FAF move_flow_to_ACB
    ## ^^ this moves the flow name to ACB
    selection_fields:
      Unit: ton-miles
    activity_sets:
      direct:
        selection_fields:
          ActivityProducedBy:
           - Truck
           - Rail
           - Water
           - Air (includes truck-air)
           - Pipeline
        activity_to_sector_mapping: FAF_Mode_and_SCTG
        attribution_method: equal

    # Split these activities with multiple possible modes proportionally to the
    # reported data for the primary modes for the same commodity.
      proportional:
        selection_fields:
          ActivityProducedBy:
           - Multiple Modes and Mail
           - Other and Unknown
        primary_action_type: Produced
        activity_to_sector_mapping: FAF_Mode_and_SCTG
        attribution_method: proportional
        attribute_on: [Flowable, PrimarySector] # to align SCTG codes
        attribution_source:
          BTS_FAF:
            selection_fields:
              Unit: ton-miles
            year: 2017
            geoscale: national
            activity_to_sector_mapping: FAF_Mode_and_SCTG
