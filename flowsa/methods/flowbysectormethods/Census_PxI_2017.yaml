!include:BEA_detail_target.yaml
# industry_spec:
#   default: NAICS_6
year: 2017
target_naics_year: 2017
geoscale: national
activity_schema: None

_attribution_sources:
  BEA: &bea # 2017 Make and Use tables
    year: 2017
    activity_to_sector_mapping: BEA_2017_Detail
    exclusion_fields:
      # Drop irrelevant final demand and total sectors
      ActivityConsumedBy: ['T001', 'T004', 'T007', 'T019']
      ActivityProducedBy: ['T007', 'T013', 'T015', 'T016', 'TOP',
                           'MCIF']
    attribution_method: equal

source_names:
  Census_EC_PxI:
    geoscale: national
    year: 2017
    data_format: FBA
    clean_fba_before_activity_sets: !script_function:Census_EC move_flow_to_ACB
    ## ^^ this moves the flow name to ACB and temporarily stores the APB
    # as the flow name
    
    ## instead could we tweak things so that we map on a diff column
    # (e.g. map to flowName instead of Activity)?
    activity_sets:
      sectors:
        # exclusion_fields: # This is done in the clean function instead
        #   ActivityProducedBy: '00'
        activity_to_sector_mapping: NAPCS_2017
        clean_fba_w_sec: !script_function:Census_EC clean_after_attr
        # Moves the FlowName back to the SPB (with no mappings/adjustments)
        # And also stores the original NAPCS code back as the flowname

        attribution_method: proportional
        attribution_source:
          BEA_Detail_Supply:
            <<: *bea
            year: 2017
